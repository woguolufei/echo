{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/channel/socket-channel.js","webpack:///./src/connector/socket-connector.js","webpack:///./src/util/uuid.js","webpack:///./src/echo.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","SocketChannel","[object Object]","options","socket","channel","this","init","event","callback","addEventListener","appid","appsecret","uuid","send","JSON","stringify","e","parse","data","onclose","readyState","WebSocket","CLOSED","type","console","error","socket_connector_SocketConnector","channels","getSocketIo","len","radix","chars","split","length","Math","random","join","host","undefined","__webpack_exports__","echo_Echo","connector"],"mappings":"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","file":"echo.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","export class SocketChannel {\r\n    constructor(options, socket, channel) {\r\n        this.options = options;\r\n\r\n        this.socket = socket;\r\n        this.channel = channel;\r\n\r\n        this.init();\r\n    }\r\n\r\n    listen(event, callback) {\r\n        let o = this;\r\n        o.socket.addEventListener('open', () => {\r\n            let value = {\r\n                appid: o.options.appid,\r\n                appsecret: o.options.appsecret,\r\n                uuid: o.socket.uuid,\r\n                channel: o.channel,\r\n                event: event\r\n            };\r\n\r\n            o.socket.send(JSON.stringify(value));\r\n        });\r\n\r\n        o.socket.addEventListener('message', (e) => {\r\n            let value = JSON.parse(e.data);\r\n            if (value.event == event) {\r\n                callback(value.data)\r\n            }\r\n        });\r\n\r\n        return this;\r\n    }\r\n\r\n    init() {\r\n        this.socket.onclose = (e) => {\r\n            if (this.socket.readyState == WebSocket.CLOSED) {\r\n                if (e.type == 'close') {\r\n                    console.error('socket服务已断开!!')\r\n                } else if (e.type == 'message') {\r\n                    console.error(e.data)\r\n                } else {\r\n                    console.error('已断开!!')\r\n                }\r\n            }\r\n        }\r\n    }\r\n}","import {SocketChannel} from '../channel/socket-channel'\r\nimport {uuid} from \"../util/uuid\"\r\n\r\nexport class SocketConnector {\r\n    constructor(options) {\r\n        this.options = options;\r\n\r\n        this.channels = {};\r\n\r\n        this.socket = this.getSocketIo();\r\n        this.socket.uuid = uuid(8, 16);\r\n    }\r\n\r\n    getSocketIo() {\r\n        return new WebSocket(this.options.host);\r\n    }\r\n\r\n    channel(channel) {\r\n        if (this.channels[channel] === undefined) {\r\n            this.channels[channel] = new SocketChannel(this.options, this.socket, channel);\r\n        }\r\n\r\n        return this.channels[channel];\r\n    }\r\n}\r\n","export function uuid(len, radix) {\r\n    var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');\r\n    var uuid = [], i;\r\n    radix = radix || chars.length;\r\n\r\n    if (len) {\r\n        // Compact form\r\n        for (i = 0; i < len; i++) uuid[i] = chars[0 | Math.random() * radix];\r\n    } else {\r\n        // rfc4122, version 4 form\r\n        var r;\r\n\r\n        // rfc4122 requires these characters\r\n        uuid[8] = uuid[13] = uuid[18] = uuid[23] = '-';\r\n        uuid[14] = '4';\r\n\r\n        // Fill in random data. At i==19 set the high bits of clock sequence as\r\n        // per rfc4122, sec. 4.1.5\r\n        for (i = 0; i < 36; i++) {\r\n            if (!uuid[i]) {\r\n                r = 0 | Math.random() * 16;\r\n                uuid[i] = chars[(i == 19) ? (r & 0x3) | 0x8 : r];\r\n            }\r\n        }\r\n    }\r\n\r\n    return uuid.join('');\r\n}","import {SocketConnector} from './connector/socket-connector'\r\n\r\nexport class Echo {\r\n    constructor(options) {\r\n        this.options = options;\r\n\r\n        this.connector = new SocketConnector(options);\r\n    }\r\n\r\n    channel(channel) {\r\n        return this.connector.channel(channel);\r\n    }\r\n\r\n}\r\n"],"sourceRoot":""}